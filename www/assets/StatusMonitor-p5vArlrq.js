import{d as q,r as _,o as J,a as Q,c as p,b as s,e as t,w as o,f as v,g as n,t as l,F as N,h as T,i as X,j as C,k as f,n as Y,_ as $}from"./index-Do0FNDZe.js";const ss={class:"status-monitor-container"},ts={class:"page-header"},es={class:"card-header"},os={class:"card-left"},ns={class:"status-info"},as={class:"info-item"},ls={class:"info-content"},is={class:"info-value"},cs={class:"info-item"},ds={class:"info-content"},rs={class:"info-value"},us={class:"info-item"},_s={class:"info-content"},ps={class:"info-value"},vs={class:"info-item"},fs={class:"info-content"},ms={class:"info-value"},gs={class:"card-header"},hs={class:"card-left"},ks={class:"service-list"},ws={class:"service-info"},Cs={class:"service-name"},ys={class:"service-port"},Rs={class:"card-header"},bs={class:"card-left"},Us={class:"device-stats"},Is={class:"stat-item"},Ss={class:"stat-content"},Ns={class:"stat-value"},Ts={class:"stat-online"},Vs={class:"stat-item"},Bs={class:"stat-content"},Ms={class:"stat-value"},xs={class:"stat-online"},Ds={class:"stat-item"},zs={class:"stat-content"},As={class:"stat-value"},Fs={class:"card-header"},Ls={class:"card-left"},Os={class:"resource-info"},Ks={class:"resource-item"},Ps={class:"resource-content"},Es={class:"resource-item"},Gs={class:"resource-content"},Hs={class:"network-stats"},Ws={class:"network-upload"},js={class:"network-download"},Zs={class:"card-header"},qs={class:"card-left"},Js={class:"card-actions"},Qs={class:"logs-container"},Xs={class:"log-time"},Ys={class:"log-message"},$s={key:0,class:"empty-logs"},st=q({__name:"StatusMonitor",setup(tt){const b=_("running"),m=_({startTime:"--",uptime:"--",memoryUsage:"--",cpuUsage:"--"}),V=_([{name:"GB28181服务",status:"running",port:5060},{name:"ONVIF服务",status:"running",port:80},{name:"API服务",status:"running",port:9080},{name:"ZLM媒体服务",status:"running",port:8554}]),d=_({gb28181:{total:0,online:0},onvif:{total:0,online:0},activeStreams:0}),g=_({diskUsage:0,network:{upload:"0 KB/s",download:"0 KB/s"}}),r=_([]),B=i=>i<70?"#67c23a":i<90?"#e6a23c":"#f56c6c",M=()=>{r.value=[]},x=i=>{const e=(i||"").toUpperCase();return e==="INFO"?"info":e==="WARN"||e==="WARNING"?"warning":e==="ERROR"?"danger":"info"},U=async()=>{try{const i=await C.get("/api/status");i.data.serverInfo&&(m.value=i.data.serverInfo);const e=await C.get("/api/stats");e.data.success&&e.data.stats&&(d.value=e.data.stats);const h=await C.get("/api/resources");if(h.data.success&&h.data.resources){const u=h.data.resources;g.value={diskUsage:u.diskUsage||0,network:u.network||{upload:"0 KB/s",download:"0 KB/s"}}}const a=await C.get("/api/logs/latest");a.data.success&&a.data.logs&&(r.value=[...a.data.logs,...r.value].slice(0,50))}catch(i){console.error("获取状态信息失败:",i),r.value.unshift({time:new Date().toLocaleTimeString(),level:"ERROR",message:"获取系统状态失败"})}};let y;return J(()=>{U(),y=setInterval(U,5e3)}),Q(()=>{y&&clearInterval(y)}),(i,e)=>{const h=n("Refresh"),a=n("el-icon"),u=n("el-button"),I=n("Monitor"),R=n("el-tag"),D=n("Clock"),z=n("Timer"),A=n("Memory"),F=n("Cpu"),k=n("el-card"),w=n("el-col"),L=n("Service"),O=n("VideoCamera"),K=n("Camera"),P=n("VideoPlay"),E=n("TrendCharts"),G=n("HardDisk"),H=n("el-progress"),W=n("Connection"),j=n("el-row"),S=n("Document");return f(),p("div",ss,[s("div",ts,[e[1]||(e[1]=s("h1",null,"系统状态监控",-1)),t(u,{type:"primary",size:"small",onClick:i.refreshAll},{default:o(()=>[t(a,null,{default:o(()=>[t(h)]),_:1}),e[0]||(e[0]=v(" 刷新数据 ",-1))]),_:1},8,["onClick"])]),t(j,{gutter:20,class:"status-grid"},{default:o(()=>[t(w,{xs:24,sm:12,lg:6},{default:o(()=>[t(k,{class:"status-card",shadow:"hover"},{header:o(()=>[s("div",es,[s("div",os,[t(a,null,{default:o(()=>[t(I)]),_:1}),e[2]||(e[2]=s("span",null,"服务器状态",-1))]),t(R,{type:b.value==="running"?"success":"danger"},{default:o(()=>[v(l(b.value==="running"?"运行中":"停止"),1)]),_:1},8,["type"])])]),default:o(()=>[s("div",ns,[s("div",as,[t(a,null,{default:o(()=>[t(D)]),_:1}),s("div",ls,[e[3]||(e[3]=s("span",{class:"info-label"},"启动时间",-1)),s("span",is,l(m.value.startTime),1)])]),s("div",cs,[t(a,null,{default:o(()=>[t(z)]),_:1}),s("div",ds,[e[4]||(e[4]=s("span",{class:"info-label"},"运行时长",-1)),s("span",rs,l(m.value.uptime),1)])]),s("div",us,[t(a,null,{default:o(()=>[t(A)]),_:1}),s("div",_s,[e[5]||(e[5]=s("span",{class:"info-label"},"内存使用",-1)),s("span",ps,l(m.value.memoryUsage),1)])]),s("div",vs,[t(a,null,{default:o(()=>[t(F)]),_:1}),s("div",fs,[e[6]||(e[6]=s("span",{class:"info-label"},"CPU使用率",-1)),s("span",ms,l(m.value.cpuUsage),1)])])])]),_:1})]),_:1}),t(w,{xs:24,sm:12,lg:6},{default:o(()=>[t(k,{class:"status-card",shadow:"hover"},{header:o(()=>[s("div",gs,[s("div",hs,[t(a,null,{default:o(()=>[t(L)]),_:1}),e[7]||(e[7]=s("span",null,"服务状态",-1))])])]),default:o(()=>[s("div",ks,[(f(!0),p(N,null,T(V.value,c=>(f(),p("div",{key:c.name,class:"service-item"},[s("div",ws,[s("span",Cs,l(c.name),1),s("span",ys,"端口: "+l(c.port),1)]),t(R,{type:c.status==="running"?"success":"danger"},{default:o(()=>[v(l(c.status==="running"?"正常":"异常"),1)]),_:2},1032,["type"])]))),128))])]),_:1})]),_:1}),t(w,{xs:24,sm:12,lg:6},{default:o(()=>[t(k,{class:"status-card",shadow:"hover"},{header:o(()=>[s("div",Rs,[s("div",bs,[t(a,null,{default:o(()=>[t(O)]),_:1}),e[8]||(e[8]=s("span",null,"设备统计",-1))])])]),default:o(()=>[s("div",Us,[s("div",Is,[t(a,null,{default:o(()=>[t(K)]),_:1}),s("div",Ss,[e[9]||(e[9]=s("span",{class:"stat-label"},"GB28181设备",-1)),s("span",Ns,l(d.value.gb28181.total),1),s("span",Ts,"在线: "+l(d.value.gb28181.online),1)])]),s("div",Vs,[t(a,null,{default:o(()=>[t(I)]),_:1}),s("div",Bs,[e[10]||(e[10]=s("span",{class:"stat-label"},"ONVIF设备",-1)),s("span",Ms,l(d.value.onvif.total),1),s("span",xs,"在线: "+l(d.value.onvif.online),1)])]),s("div",Ds,[t(a,null,{default:o(()=>[t(P)]),_:1}),s("div",zs,[e[11]||(e[11]=s("span",{class:"stat-label"},"活跃流",-1)),s("span",As,l(d.value.activeStreams),1)])])])]),_:1})]),_:1}),t(w,{xs:24,sm:12,lg:6},{default:o(()=>[t(k,{class:"status-card",shadow:"hover"},{header:o(()=>[s("div",Fs,[s("div",Ls,[t(a,null,{default:o(()=>[t(E)]),_:1}),e[12]||(e[12]=s("span",null,"系统资源",-1))])])]),default:o(()=>[s("div",Os,[s("div",Ks,[t(a,null,{default:o(()=>[t(G)]),_:1}),s("div",Ps,[e[13]||(e[13]=s("span",{class:"resource-label"},"磁盘使用率",-1)),t(H,{percentage:g.value.diskUsage,color:B(g.value.diskUsage)},null,8,["percentage","color"])])]),s("div",Es,[t(a,null,{default:o(()=>[t(W)]),_:1}),s("div",Gs,[e[14]||(e[14]=s("span",{class:"resource-label"},"网络流量",-1)),s("div",Hs,[s("span",Ws,"上传: "+l(g.value.network.upload),1),s("span",js,"下载: "+l(g.value.network.download),1)])])])])]),_:1})]),_:1})]),_:1}),t(k,{class:"logs-card",shadow:"hover"},{header:o(()=>[s("div",Zs,[s("div",qs,[t(a,null,{default:o(()=>[t(S)]),_:1}),e[15]||(e[15]=s("span",null,"实时日志",-1))]),s("div",Js,[t(u,{size:"small",onClick:i.toggleAutoRefresh},{default:o(()=>[v(l(i.autoRefresh?"停止自动刷新":"开启自动刷新"),1)]),_:1},8,["onClick"]),t(u,{size:"small",onClick:M},{default:o(()=>[...e[16]||(e[16]=[v("清空日志",-1)])]),_:1})])])]),default:o(()=>[s("div",Qs,[(f(!0),p(N,null,T(r.value,(c,Z)=>(f(),p("div",{key:Z,class:Y(["log-entry",c.level])},[s("span",Xs,l(c.time),1),t(R,{type:x(c.level),size:"small"},{default:o(()=>[v(l(c.level.toUpperCase()),1)]),_:2},1032,["type"]),s("span",Ys,l(c.message),1)],2))),128)),r.value.length===0?(f(),p("div",$s,[t(a,null,{default:o(()=>[t(S)]),_:1}),e[17]||(e[17]=s("span",null,"暂无日志",-1))])):X("",!0)])]),_:1})])}}}),ot=$(st,[["__scopeId","data-v-fd20872c"]]);export{ot as default};
