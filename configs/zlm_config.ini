# ZLMediaKit 配置文件模板
# 此文件由 scripts/build_zlm.sh 生成，可根据需要修改

[api]
# HTTP API 调试模式
apiDebug=1
# API 密钥 (通过 127.0.0.1 访问可不提供)
secret=lJVRv67NnTsUMdq7nwybzCUBTcsyyR7x
# 截图保存路径
snapRoot=./www/snap/
# 下载根目录
downloadRoot=./www

[ffmpeg]
bin=/usr/bin/ffmpeg
# 使用 FFmpeg 将 H.265/HEVC 转码为 H.264，以便浏览器和部分播放器兼容。
# 模板说明: 第一个参数是 ffmpeg 可执行路径, 第二个是输入URL, 第三个是输出URL
# 该命令使用低延迟参数并保证视频转为 libx264，音频转为 aac。
cmd=%s -rtsp_transport tcp -re -i %s -c:a aac -b:a 64k -c:v libx264 -preset veryfast -tune zerolatency -x264-params keyint=50 -f flv %s
snap=%s -i %s -y -f mjpeg -frames:v 1 -an %s
log=./ffmpeg/ffmpeg.log
restart_sec=0

[protocol]
modify_stamp=2
enable_audio=1
add_mute_audio=1
auto_close=0
demux_frame=1
continue_push_ms=15000
paced_sender_ms=0
enable_hls=1
enable_hls_fmp4=0
enable_mp4=0
enable_rtsp=1
enable_rtmp=1
enable_ts=1
enable_fmp4=1
mp4_as_player=0
mp4_max_second=3600
mp4_save_path=./www
hls_save_path=./www
hls_demand=0
rtsp_demand=0
rtmp_demand=0
ts_demand=0
fmp4_demand=0

[general]
# 是否启用虚拟主机
enableVhost=0
# 播放器超时时间 (秒)
streamNoneReaderDelayMS=20000
# 最大等待未初始化的Track时间 (秒)
maxStreamWaitMS=15000
# 流无人观看多久后关闭
unready_frame_cache=100
# 合并写缓存大小
mergeWriteMS=0
# 重置流媒体信息超时时间
resetWhenRePlay=1
# 是否开启 FFmpeg 日志
publishToHls=1
publishToMP4=0
# 转协议时最大连续空帧数
maxNotFoundStream=100
# 播放鉴权超时时间
flowThreshold=1024

[hls]
# HLS 切片数量
segNum=3
# 切片时长 (秒)
segDur=2
# 深度
segRetain=5
# 文件路径
filePath=./www
# 每次切片后回调
broadcastRecordTs=0
# 删除延时
deleteDelaySec=10

[hook]
# 是否启用 hook
enable=0
# hook 超时时间
timeoutSec=10
# keepalive 超时时间
alive_interval=30
# hook 重试次数
retry_delay=3
# 流注册或注销回调
on_flow_report=
on_http_access=
on_play=
on_publish=
on_record_mp4=
on_record_ts=
on_rtsp_auth=
on_rtsp_realm=
on_shell_login=
on_stream_changed=
on_stream_none_reader=
on_stream_not_found=
on_server_started=
on_send_rtp_stopped=
on_rtp_server_timeout=

[http]
# HTTP 端口
port=80
# HTTPS 端口
sslport=443
# 根目录
rootPath=./www
# 最大连接数
maxReqSize=40960
# 是否显示目录列表
dirMenu=1
# 虚拟目录
virtualPath=
# 字符集
charSet=utf-8
# 是否开启 keep-alive
keepAliveSecond=30
# 发送缓冲区大小
sendBufSize=65536
# 是否允许跨域
allow_cross_domain=1
# 是否启用 IP 转发
forwarded_ip_header=

[multicast]
# 组播地址
addrMax=239.255.255.255
addrMin=239.0.0.0
udpTTL=64

[record]
# 录制应用名
appName=record
# 录制路径
filePath=./www
# 单个文件最大时长 (秒)
fileSecond=3600
# 录制 MP4/HLS 采样间隔
sampleMS=500
# 快速录制模式
fastStart=0
# 循环录制
fileRepeat=0

[rtmp]
# RTMP 端口
port=1935
# RTMPS 端口
sslport=0
# 握手超时时间
handshakeSecond=15
# 保持连接超时时间
keepAliveSecond=15
# 是否开启增强型 RTMP (H.265 支持)
enhanced=0

[rtp]
# RTP 音频载荷类型
audioMtuSize=600
# RTP 视频载荷类型
videoMtuSize=1400
# RTP 超时时间
rtpMaxSize=10

[rtp_proxy]
# RTP 代理端口 (GB28181)
port=10000
# 超时时间
timeoutSec=15
# 端口范围
port_range=30000-35000

[rtsp]
# RTSP 端口
port=554
# RTSPS 端口
sslport=0
# 直接代理
directProxy=1
# 握手超时时间
handshakeSecond=15
# 保持连接超时时间
keepAliveSecond=15
# 低延迟模式
lowLatency=0
# RTP over TCP/UDP
rtpTransportType=-1

[shell]
# 是否开启调试 shell
enable=0
# 调试 shell 端口
port=9000
# 最大连接数
maxReqSize=1024

[srt]
# SRT 端口
port=9000
# 延迟
latencyMul=4
# 拥塞控制
pktBufSize=8192
# 超时时间
timeoutSec=5

[webrtc]
# WebRTC 端口
port=8000
# 超时时间
timeoutSec=30
# 外部 IP (用于 NAT 穿透)
externIP=
# 端口范围
port_range=50000-60000
# 优先 TCP
preferredType=0
# RTP 扩展
rtp_ext_enable=0
